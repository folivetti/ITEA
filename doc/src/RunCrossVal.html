<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : CROSSVAL
Description : Hyperparameter tuning for ITEA
Copyright   : (c) Fabricio Olivetti de Franca, 2020
License     : GPL-3
Maintainer  : fabricio.olivetti@gmail.com
Stability   : experimental
Portability : POSIX

Hyperparameter tuning for ITEA
-}</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">RunCrossVal</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="ITEA.Config.html"><span class="hs-identifier">ITEA.Config</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IT.ITEA.html"><span class="hs-identifier">IT.ITEA</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IT.Regression.html"><span class="hs-identifier">IT.Regression</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="IT.Algorithms.html"><span class="hs-identifier">IT.Algorithms</span></a></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.LinearAlgebra</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LA</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ord</span></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random.SplitMix</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random.Shuffle</span></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">-- | Creates a mutation configuration instance</span><span>
</span><span id="line-30"></span><span id="createMutCfg"><span class="annot"><span class="annottext">createMutCfg :: (Int, Int) -&gt; Int -&gt; c -&gt; (MutationCfg, c, c)
</span><a href="RunCrossVal.html#createMutCfg"><span class="hs-identifier hs-var hs-var">createMutCfg</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112953"><span class="annot"><span class="annottext">e1 :: Int
</span><a href="#local-6989586621679112953"><span class="hs-identifier hs-var">e1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679112952"><span class="annot"><span class="annottext">e2 :: Int
</span><a href="#local-6989586621679112952"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679112951"><span class="annot"><span class="annottext">tmax :: Int
</span><a href="#local-6989586621679112951"><span class="hs-identifier hs-var">tmax</span></a></span></span><span> </span><span id="local-6989586621679112950"><span class="annot"><span class="annottext">pop :: c
</span><a href="#local-6989586621679112950"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MutationCfg
</span><a href="#local-6989586621679112949"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679112950"><span class="hs-identifier hs-var">pop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">100000</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; c -&gt; c
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679112950"><span class="hs-identifier hs-var">pop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679112949"><span class="annot"><span class="annottext">cfg :: MutationCfg
</span><a href="#local-6989586621679112949"><span class="hs-identifier hs-var hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UncheckedMutationCfg -&gt; MutationCfg
forall a b. Valid a b =&gt; a -&gt; b
</span><a href="ITEA.Config.html#validateConfig"><span class="hs-identifier hs-var">validateConfig</span></a></span><span>
</span><span id="line-32"></span><span>            </span><span class="annot"><span class="annottext">(UncheckedMutationCfg -&gt; MutationCfg)
-&gt; UncheckedMutationCfg -&gt; MutationCfg
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; UncheckedMutationCfg
</span><a href="ITEA.Config.html#exponents"><span class="hs-identifier hs-var">exponents</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112953"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112952"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-33"></span><span>            </span><span class="annot"><span class="annottext">UncheckedMutationCfg
-&gt; UncheckedMutationCfg -&gt; UncheckedMutationCfg
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; UncheckedMutationCfg
</span><a href="ITEA.Config.html#termLimit"><span class="hs-identifier hs-var">termLimit</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112951"><span class="hs-identifier hs-var">tmax</span></a></span><span>
</span><span id="line-34"></span><span>            </span><span class="annot"><span class="annottext">UncheckedMutationCfg
-&gt; UncheckedMutationCfg -&gt; UncheckedMutationCfg
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; UncheckedMutationCfg
</span><a href="ITEA.Config.html#nonzeroExps"><span class="hs-identifier hs-var">nonzeroExps</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-35"></span><span>            </span><span class="annot"><span class="annottext">UncheckedMutationCfg
-&gt; UncheckedMutationCfg -&gt; UncheckedMutationCfg
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Funcs -&gt; UncheckedMutationCfg
</span><a href="ITEA.Config.html#transFunctions"><span class="hs-identifier hs-var">transFunctions</span></a></span><span> </span><span class="annot"><span class="annottext">Funcs
</span><a href="ITEA.Config.html#FAll"><span class="hs-identifier hs-var">FAll</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | Validates the program arguments</span><span>
</span><span id="line-38"></span><span class="annot"><a href="RunCrossVal.html#validateArgs"><span class="hs-identifier hs-type">validateArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span id="validateArgs"><span class="annot"><span class="annottext">validateArgs :: [String] -&gt; (String, Int)
</span><a href="RunCrossVal.html#validateArgs"><span class="hs-identifier hs-var hs-var">validateArgs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112940"><span class="annot"><span class="annottext">x :: String
</span><a href="#local-6989586621679112940"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679112939"><span class="annot"><span class="annottext">y :: String
</span><a href="#local-6989586621679112939"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679112940"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679112939"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="annot"><a href="RunCrossVal.html#validateArgs"><span class="hs-identifier hs-var">validateArgs</span></a></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, Int)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Usage: crossval dataname fold&quot;</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- | Runs a single experiment with a given configuration</span><span>
</span><span id="line-43"></span><span class="annot"><a href="RunCrossVal.html#runITEARegCV"><span class="hs-identifier hs-type">runITEARegCV</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="IT.Algorithms.html#Fitness"><span class="hs-identifier hs-type">Fitness</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><a href="IT.Regression.html#RegStats"><span class="hs-identifier hs-type">RegStats</span></a></span><span>                </span><span class="hs-comment">-- ^ Training fitness function</span><span>
</span><span id="line-44"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="IT.Algorithms.html#Solution"><span class="hs-identifier hs-type">Solution</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><a href="IT.Regression.html#RegStats"><span class="hs-identifier hs-type">RegStats</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="IT.Regression.html#RegStats"><span class="hs-identifier hs-type">RegStats</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Test fitness function</span><span>
</span><span id="line-45"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                                                 </span><span class="hs-comment">-- ^ Problem dimension</span><span>
</span><span id="line-46"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="ITEA.Config.html#MutationCfg"><span class="hs-identifier hs-type">MutationCfg</span></a></span><span>                                         </span><span class="hs-comment">-- ^ Mutation configuration</span><span>
</span><span id="line-47"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                                                 </span><span class="hs-comment">-- ^ population size</span><span>
</span><span id="line-48"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                                                 </span><span class="hs-comment">-- ^ number of generations</span><span>
</span><span id="line-49"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-50"></span><span id="runITEARegCV"><span class="annot"><span class="annottext">runITEARegCV :: Fitness Double RegStats
-&gt; (Solution Double RegStats -&gt; RegStats)
-&gt; Int
-&gt; MutationCfg
-&gt; Int
-&gt; Int
-&gt; IO Double
</span><a href="RunCrossVal.html#runITEARegCV"><span class="hs-identifier hs-var hs-var">runITEARegCV</span></a></span></span><span> </span><span id="local-6989586621679112935"><span class="annot"><span class="annottext">fitTrain :: Fitness Double RegStats
</span><a href="#local-6989586621679112935"><span class="hs-identifier hs-var">fitTrain</span></a></span></span><span> </span><span id="local-6989586621679112934"><span class="annot"><span class="annottext">fitTest :: Solution Double RegStats -&gt; RegStats
</span><a href="#local-6989586621679112934"><span class="hs-identifier hs-var">fitTest</span></a></span></span><span> </span><span id="local-6989586621679112933"><span class="annot"><span class="annottext">dim :: Int
</span><a href="#local-6989586621679112933"><span class="hs-identifier hs-var">dim</span></a></span></span><span> </span><span id="local-6989586621679112932"><span class="annot"><span class="annottext">mcfg :: MutationCfg
</span><a href="#local-6989586621679112932"><span class="hs-identifier hs-var">mcfg</span></a></span></span><span> </span><span id="local-6989586621679112931"><span class="annot"><span class="annottext">nPop :: Int
</span><a href="#local-6989586621679112931"><span class="hs-identifier hs-var">nPop</span></a></span></span><span> </span><span id="local-6989586621679112930"><span class="annot"><span class="annottext">nGens :: Int
</span><a href="#local-6989586621679112930"><span class="hs-identifier hs-var">nGens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-comment">-- random seed</span><span>
</span><span id="line-52"></span><span>  </span><span id="local-6989586621679112929"><span class="annot"><span class="annottext">SMGen
</span><a href="#local-6989586621679112929"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO SMGen
</span><span class="hs-identifier hs-var">initSMGen</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-comment">-- run ITEA with given configuration</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112927"><span class="annot"><span class="annottext">mutFun :: Mutation Double
</span><a href="#local-6989586621679112927"><span class="hs-identifier hs-var">mutFun</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112926"><span class="annot"><span class="annottext">rndTerm :: Rnd (Term Double)
</span><a href="#local-6989586621679112926"><span class="hs-identifier hs-var">rndTerm</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MutationCfg -&gt; Int -&gt; (Mutation Double, Rnd (Term Double))
</span><a href="ITEA.Config.html#withMutation"><span class="hs-identifier hs-var">withMutation</span></a></span><span> </span><span class="annot"><span class="annottext">MutationCfg
</span><a href="#local-6989586621679112932"><span class="hs-identifier hs-var">mcfg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112933"><span class="hs-identifier hs-var">dim</span></a></span><span>
</span><span id="line-56"></span><span>      </span><span id="local-6989586621679112924"><span class="annot"><span class="annottext">p0 :: Rnd (Population Double RegStats)
</span><a href="#local-6989586621679112924"><span class="hs-identifier hs-var hs-var">p0</span></a></span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Int
-&gt; Int
-&gt; Rnd (Term Double)
-&gt; Fitness Double RegStats
-&gt; Rnd (Population Double RegStats)
forall a b.
Int
-&gt; Int
-&gt; Int
-&gt; Rnd (Term a)
-&gt; Fitness a b
-&gt; Rnd (Population a b)
</span><a href="IT.ITEA.html#initialPop"><span class="hs-identifier hs-var">initialPop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112933"><span class="hs-identifier hs-var">dim</span></a></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112931"><span class="hs-identifier hs-var">nPop</span></a></span><span> </span><span class="annot"><span class="annottext">Rnd (Term Double)
</span><a href="#local-6989586621679112926"><span class="hs-identifier hs-var">rndTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Fitness Double RegStats
</span><a href="#local-6989586621679112935"><span class="hs-identifier hs-var">fitTrain</span></a></span><span>
</span><span id="line-57"></span><span>      </span><span id="local-6989586621679112922"><span class="annot"><span class="annottext">gens :: [Population Double RegStats]
</span><a href="#local-6989586621679112922"><span class="hs-identifier hs-var hs-var">gens</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rnd (Population Double RegStats)
</span><a href="#local-6989586621679112924"><span class="hs-identifier hs-var">p0</span></a></span><span> </span><span class="annot"><span class="annottext">Rnd (Population Double RegStats)
-&gt; (Population Double RegStats
    -&gt; StateT SMGen Identity [Population Double RegStats])
-&gt; StateT SMGen Identity [Population Double RegStats]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Mutation Double
-&gt; Fitness Double RegStats
-&gt; Population Double RegStats
-&gt; StateT SMGen Identity [Population Double RegStats]
forall a b.
(NFData a, NFData b) =&gt;
Mutation a -&gt; Fitness a b -&gt; Population a b -&gt; Rnd [Population a b]
</span><a href="IT.ITEA.html#itea"><span class="hs-identifier hs-var">itea</span></a></span><span> </span><span class="annot"><span class="annottext">Mutation Double
</span><a href="#local-6989586621679112927"><span class="hs-identifier hs-var">mutFun</span></a></span><span> </span><span class="annot"><span class="annottext">Fitness Double RegStats
</span><a href="#local-6989586621679112935"><span class="hs-identifier hs-var">fitTrain</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT SMGen Identity [Population Double RegStats]
-&gt; SMGen -&gt; [Population Double RegStats]
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-operator hs-var">`evalState`</span></span><span> </span><span class="annot"><span class="annottext">SMGen
</span><a href="#local-6989586621679112929"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-58"></span><span>      </span><span id="local-6989586621679112919"><span class="annot"><span class="annottext">best :: Solution Double RegStats
</span><a href="#local-6989586621679112919"><span class="hs-identifier hs-var hs-var">best</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Population Double RegStats] -&gt; Solution Double RegStats
</span><a href="ITEA.Config.html#getBest"><span class="hs-identifier hs-var">getBest</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112930"><span class="hs-identifier hs-var">nGens</span></a></span><span> </span><span class="annot"><span class="annottext">[Population Double RegStats]
</span><a href="#local-6989586621679112922"><span class="hs-identifier hs-var">gens</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; IO Double
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span class="annot"><span class="annottext">(Double -&gt; IO Double)
-&gt; (Solution Double RegStats -&gt; Double)
-&gt; Solution Double RegStats
-&gt; IO Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">RegStats -&gt; Double
</span><a href="IT.Regression.html#_rmse"><span class="hs-identifier hs-var hs-var">_rmse</span></a></span><span class="annot"><span class="annottext">(RegStats -&gt; Double)
-&gt; (Solution Double RegStats -&gt; RegStats)
-&gt; Solution Double RegStats
-&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Solution Double RegStats -&gt; RegStats
</span><a href="#local-6989586621679112934"><span class="hs-identifier hs-var">fitTest</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Solution Double RegStats
</span><a href="#local-6989586621679112919"><span class="hs-identifier hs-var">best</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span id="average"><span class="annot"><span class="annottext">average :: t a -&gt; a
</span><a href="RunCrossVal.html#average"><span class="hs-identifier hs-var hs-var">average</span></a></span></span><span> </span><span id="local-6989586621679112914"><span class="annot"><span class="annottext">xs :: t a
</span><a href="#local-6989586621679112914"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t a -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679112914"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679112911"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679112911"><span class="annot"><span class="annottext">l :: a
</span><a href="#local-6989586621679112911"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679112914"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>  </span><span>
</span><span id="line-64"></span><span id="cycle%27"><span class="annot"><span class="annottext">cycle' :: [a] -&gt; [a]
</span><a href="RunCrossVal.html#cycle%27"><span class="hs-identifier hs-var hs-var">cycle'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112908"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679112908"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679112907"><span class="annot"><span class="annottext">xs :: [a]
</span><a href="#local-6989586621679112907"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679112907"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679112908"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | runs a configuration for a given data set</span><span>
</span><span id="line-67"></span><span class="annot"><a href="RunCrossVal.html#runCfg"><span class="hs-identifier hs-type">runCfg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="ITEA.Config.html#MutationCfg"><span class="hs-identifier hs-type">MutationCfg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-68"></span><span id="runCfg"><span class="annot"><span class="annottext">runCfg :: String -&gt; Int -&gt; (MutationCfg, Int, Int) -&gt; IO Double
</span><a href="RunCrossVal.html#runCfg"><span class="hs-identifier hs-var hs-var">runCfg</span></a></span></span><span> </span><span id="local-6989586621679112905"><span class="annot"><span class="annottext">dname :: String
</span><a href="#local-6989586621679112905"><span class="hs-identifier hs-var">dname</span></a></span></span><span> </span><span id="local-6989586621679112904"><span class="annot"><span class="annottext">fold :: Int
</span><a href="#local-6989586621679112904"><span class="hs-identifier hs-var">fold</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112903"><span class="annot"><span class="annottext">mutCfg :: MutationCfg
</span><a href="#local-6989586621679112903"><span class="hs-identifier hs-var">mutCfg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112902"><span class="annot"><span class="annottext">pop :: Int
</span><a href="#local-6989586621679112902"><span class="hs-identifier hs-var">pop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112901"><span class="annot"><span class="annottext">gen :: Int
</span><a href="#local-6989586621679112901"><span class="hs-identifier hs-var">gen</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679112900"><span class="annot"><span class="annottext">fname :: String
</span><a href="#local-6989586621679112900"><span class="hs-identifier hs-var hs-var">fname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;datasets/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679112905"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679112905"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;-train-&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.dat&quot;</span></span><span> </span><span>
</span><span id="line-70"></span><span>  </span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679112898"><span class="annot"><span class="annottext">trainX :: Matrix Double
</span><a href="#local-6989586621679112898"><span class="hs-identifier hs-var">trainX</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112897"><span class="annot"><span class="annottext">trainY :: Vector
</span><a href="#local-6989586621679112897"><span class="hs-identifier hs-var">trainY</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Matrix Double, Vector)
</span><a href="ITEA.Config.html#parseFile"><span class="hs-identifier hs-var">parseFile</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (Matrix Double, Vector))
-&gt; IO String -&gt; IO (Matrix Double, Vector)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><span class="hs-identifier hs-var">readFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679112900"><span class="hs-identifier hs-var">fname</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span id="local-6989586621679112893"><span class="annot"><span class="annottext">SMGen
</span><a href="#local-6989586621679112893"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO SMGen
</span><span class="hs-identifier hs-var">initSMGen</span></span><span>
</span><span id="line-73"></span><span>  </span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679112892"><span class="annot"><span class="annottext">nRows :: Int
</span><a href="#local-6989586621679112892"><span class="hs-identifier hs-var hs-var">nRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix Double -&gt; Int
forall t. Matrix t -&gt; Int
</span><span class="hs-identifier hs-var">LA.rows</span></span><span> </span><span class="annot"><span class="annottext">Matrix Double
</span><a href="#local-6989586621679112898"><span class="hs-identifier hs-var">trainX</span></a></span><span>
</span><span id="line-75"></span><span>      </span><span id="local-6989586621679112890"><span class="annot"><span class="annottext">dim :: Int
</span><a href="#local-6989586621679112890"><span class="hs-identifier hs-var hs-var">dim</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix Double -&gt; Int
forall t. Matrix t -&gt; Int
</span><span class="hs-identifier hs-var">LA.cols</span></span><span> </span><span class="annot"><span class="annottext">Matrix Double
</span><a href="#local-6989586621679112898"><span class="hs-identifier hs-var">trainX</span></a></span><span>
</span><span id="line-76"></span><span>      </span><span>
</span><span id="line-77"></span><span>      </span><span class="hs-comment">-- random 5-cv split</span><span>
</span><span id="line-78"></span><span>      </span><span id="local-6989586621679112888"><span class="annot"><span class="annottext">rndix :: [Int]
</span><a href="#local-6989586621679112888"><span class="hs-identifier hs-var hs-var">rndix</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int -&gt; SMGen -&gt; [Int]
forall gen a. RandomGen gen =&gt; [a] -&gt; Int -&gt; gen -&gt; [a]
</span><span class="hs-identifier hs-var">shuffle'</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112892"><span class="hs-identifier hs-var">nRows</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112892"><span class="hs-identifier hs-var">nRows</span></a></span><span> </span><span class="annot"><span class="annottext">SMGen
</span><a href="#local-6989586621679112893"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-79"></span><span>      </span><span id="local-6989586621679112886"><span class="annot"><span class="annottext">nRows' :: Int
</span><a href="#local-6989586621679112886"><span class="hs-identifier hs-var hs-var">nRows'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112892"><span class="hs-identifier hs-var">nRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="hs-number">5</span></span><span>
</span><span id="line-80"></span><span>      </span><span id="local-6989586621679112885"><span class="annot"><span class="annottext">idxs :: [[Int]]
</span><a href="#local-6989586621679112885"><span class="hs-identifier hs-var hs-var">idxs</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112886"><span class="hs-identifier hs-var">nRows'</span></a></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; [Int]) -&gt; [Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112882"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112886"><span class="hs-identifier hs-var">nRows'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679112888"><span class="hs-identifier hs-var">rndix</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679112882"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112882"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-81"></span><span>      </span><span id="local-6989586621679112880"><span class="annot"><span class="annottext">folds :: [([Int], [Int])]
</span><a href="#local-6989586621679112880"><span class="hs-identifier hs-var hs-var">folds</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [([Int], [Int])] -&gt; [([Int], [Int])]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">([([Int], [Int])] -&gt; [([Int], [Int])])
-&gt; [([Int], [Int])] -&gt; [([Int], [Int])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([[Int]] -&gt; ([Int], [Int])) -&gt; [[[Int]]] -&gt; [([Int], [Int])]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679112879"><span class="annot"><span class="annottext">x :: [Int]
</span><a href="#local-6989586621679112879"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679112878"><span class="annot"><span class="annottext">xs :: [[Int]]
</span><a href="#local-6989586621679112878"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[Int]] -&gt; [Int]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679112878"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679112879"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[[Int]]] -&gt; [([Int], [Int])]) -&gt; [[[Int]]] -&gt; [([Int], [Int])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([[Int]] -&gt; [[Int]]) -&gt; [[Int]] -&gt; [[[Int]]]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="annot"><span class="annottext">[[Int]] -&gt; [[Int]]
forall a. [a] -&gt; [a]
</span><a href="RunCrossVal.html#cycle%27"><span class="hs-identifier hs-var">cycle'</span></a></span><span> </span><span class="annot"><span class="annottext">[[Int]]
</span><a href="#local-6989586621679112885"><span class="hs-identifier hs-var">idxs</span></a></span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-comment">--idxs1 = take (nRows `div` 2) rndix</span><span>
</span><span id="line-83"></span><span>      </span><span class="hs-comment">--idxs2 = drop (nRows `div` 2) rndix</span><span>
</span><span id="line-84"></span><span>      </span><span>
</span><span id="line-85"></span><span>      </span><span class="hs-comment">-- tr = training, tv = validation</span><span>
</span><span id="line-86"></span><span>      </span><span id="local-6989586621679112875"><span class="annot"><span class="annottext">getY :: [Int] -&gt; Vector
</span><a href="#local-6989586621679112875"><span class="hs-identifier hs-var hs-var">getY</span></a></span></span><span> </span><span id="local-6989586621679112874"><span class="annot"><span class="annottext">is :: [Int]
</span><a href="#local-6989586621679112874"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix Double -&gt; Vector
forall t. Element t =&gt; Matrix t -&gt; Vector t
</span><span class="hs-identifier hs-var">LA.flatten</span></span><span> </span><span class="annot"><span class="annottext">(Matrix Double -&gt; Vector) -&gt; Matrix Double -&gt; Vector
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector -&gt; Matrix Double
forall a. Storable a =&gt; Vector a -&gt; Matrix a
</span><span class="hs-identifier hs-var">LA.asColumn</span></span><span> </span><span class="annot"><span class="annottext">Vector
</span><a href="#local-6989586621679112897"><span class="hs-identifier hs-var">trainY</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Matrix Double -&gt; (Extractor, Extractor) -&gt; Matrix Double
forall t.
Element t =&gt;
Matrix t -&gt; (Extractor, Extractor) -&gt; Matrix t
</span><span class="hs-operator hs-var">LA.??</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector I -&gt; Extractor
</span><span class="hs-identifier hs-var">LA.Pos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Vector I
</span><span class="hs-identifier hs-var">LA.idxs</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679112874"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Extractor
</span><span class="hs-identifier hs-var">LA.All</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>      </span><span id="local-6989586621679112867"><span class="annot"><span class="annottext">getX :: [Int] -&gt; Matrix Double
</span><a href="#local-6989586621679112867"><span class="hs-identifier hs-var hs-var">getX</span></a></span></span><span> </span><span id="local-6989586621679112866"><span class="annot"><span class="annottext">is :: [Int]
</span><a href="#local-6989586621679112866"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Matrix Double
</span><a href="#local-6989586621679112898"><span class="hs-identifier hs-var">trainX</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Double -&gt; (Extractor, Extractor) -&gt; Matrix Double
forall t.
Element t =&gt;
Matrix t -&gt; (Extractor, Extractor) -&gt; Matrix t
</span><span class="hs-operator hs-var">LA.??</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector I -&gt; Extractor
</span><span class="hs-identifier hs-var">LA.Pos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Vector I
</span><span class="hs-identifier hs-var">LA.idxs</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679112866"><span class="hs-identifier hs-var">is</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Extractor
</span><span class="hs-identifier hs-var">LA.All</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>      </span><span>
</span><span id="line-89"></span><span>      </span><span id="local-6989586621679112865"><span class="annot"><span class="annottext">trYs :: [Vector]
</span><a href="#local-6989586621679112865"><span class="hs-identifier hs-var hs-var">trYs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Int], [Int]) -&gt; Vector) -&gt; [([Int], [Int])] -&gt; [Vector]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Vector
</span><a href="#local-6989586621679112875"><span class="hs-identifier hs-var">getY</span></a></span><span class="annot"><span class="annottext">([Int] -&gt; Vector)
-&gt; (([Int], [Int]) -&gt; [Int]) -&gt; ([Int], [Int]) -&gt; Vector
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">([Int], [Int]) -&gt; [Int]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Int], [Int])]
</span><a href="#local-6989586621679112880"><span class="hs-identifier hs-var">folds</span></a></span><span>
</span><span id="line-90"></span><span>      </span><span id="local-6989586621679112864"><span class="annot"><span class="annottext">tvYs :: [Vector]
</span><a href="#local-6989586621679112864"><span class="hs-identifier hs-var hs-var">tvYs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Int], [Int]) -&gt; Vector) -&gt; [([Int], [Int])] -&gt; [Vector]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Vector
</span><a href="#local-6989586621679112875"><span class="hs-identifier hs-var">getY</span></a></span><span class="annot"><span class="annottext">([Int] -&gt; Vector)
-&gt; (([Int], [Int]) -&gt; [Int]) -&gt; ([Int], [Int]) -&gt; Vector
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">([Int], [Int]) -&gt; [Int]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Int], [Int])]
</span><a href="#local-6989586621679112880"><span class="hs-identifier hs-var">folds</span></a></span><span>
</span><span id="line-91"></span><span>      </span><span>
</span><span id="line-92"></span><span>      </span><span id="local-6989586621679112863"><span class="annot"><span class="annottext">trXs :: [Matrix Double]
</span><a href="#local-6989586621679112863"><span class="hs-identifier hs-var hs-var">trXs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Int], [Int]) -&gt; Matrix Double)
-&gt; [([Int], [Int])] -&gt; [Matrix Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Matrix Double
</span><a href="#local-6989586621679112867"><span class="hs-identifier hs-var">getX</span></a></span><span class="annot"><span class="annottext">([Int] -&gt; Matrix Double)
-&gt; (([Int], [Int]) -&gt; [Int]) -&gt; ([Int], [Int]) -&gt; Matrix Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">([Int], [Int]) -&gt; [Int]
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Int], [Int])]
</span><a href="#local-6989586621679112880"><span class="hs-identifier hs-var">folds</span></a></span><span>
</span><span id="line-93"></span><span>      </span><span id="local-6989586621679112862"><span class="annot"><span class="annottext">tvXs :: [Matrix Double]
</span><a href="#local-6989586621679112862"><span class="hs-identifier hs-var hs-var">tvXs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Int], [Int]) -&gt; Matrix Double)
-&gt; [([Int], [Int])] -&gt; [Matrix Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int] -&gt; Matrix Double
</span><a href="#local-6989586621679112867"><span class="hs-identifier hs-var">getX</span></a></span><span class="annot"><span class="annottext">([Int] -&gt; Matrix Double)
-&gt; (([Int], [Int]) -&gt; [Int]) -&gt; ([Int], [Int]) -&gt; Matrix Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">([Int], [Int]) -&gt; [Int]
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[([Int], [Int])]
</span><a href="#local-6989586621679112880"><span class="hs-identifier hs-var">folds</span></a></span><span>
</span><span id="line-94"></span><span>      </span><span>
</span><span id="line-95"></span><span>      </span><span id="local-6989586621679112861"><span class="annot"><span class="annottext">toRegMtx :: Matrix Double -&gt; Vector Vector
</span><a href="#local-6989586621679112861"><span class="hs-identifier hs-var hs-var">toRegMtx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Vector] -&gt; Vector Vector
forall a. [a] -&gt; Vector a
</span><span class="hs-identifier hs-var">V.fromList</span></span><span> </span><span class="annot"><span class="annottext">([Vector] -&gt; Vector Vector)
-&gt; (Matrix Double -&gt; [Vector]) -&gt; Matrix Double -&gt; Vector Vector
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Matrix Double -&gt; [Vector]
forall t. Element t =&gt; Matrix t -&gt; [Vector t]
</span><span class="hs-identifier hs-var">LA.toColumns</span></span><span>
</span><span id="line-96"></span><span>      </span><span>
</span><span id="line-97"></span><span>      </span><span id="local-6989586621679112858"><span class="annot"><span class="annottext">fitTrains :: [Fitness Double RegStats]
</span><a href="#local-6989586621679112858"><span class="hs-identifier hs-var hs-var">fitTrains</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Matrix Double -&gt; Vector -&gt; Fitness Double RegStats)
-&gt; [Matrix Double] -&gt; [Vector] -&gt; [Fitness Double RegStats]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679112856"><span class="annot"><span class="annottext">x :: Matrix Double
</span><a href="#local-6989586621679112856"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679112855"><span class="annot"><span class="annottext">y :: Vector
</span><a href="#local-6989586621679112855"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Vector Vector -&gt; Vector -&gt; Fitness Double RegStats
</span><a href="IT.Regression.html#fitnessReg"><span class="hs-identifier hs-var">fitnessReg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112902"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix Double -&gt; Vector Vector
</span><a href="#local-6989586621679112861"><span class="hs-identifier hs-var">toRegMtx</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Double
</span><a href="#local-6989586621679112856"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector
</span><a href="#local-6989586621679112855"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Matrix Double]
</span><a href="#local-6989586621679112863"><span class="hs-identifier hs-var">trXs</span></a></span><span> </span><span class="annot"><span class="annottext">[Vector]
</span><a href="#local-6989586621679112865"><span class="hs-identifier hs-var">trYs</span></a></span><span>
</span><span id="line-98"></span><span>      </span><span id="local-6989586621679112853"><span class="annot"><span class="annottext">fitTests :: [Solution Double RegStats -&gt; RegStats]
</span><a href="#local-6989586621679112853"><span class="hs-identifier hs-var hs-var">fitTests</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">(Matrix Double -&gt; Vector -&gt; Solution Double RegStats -&gt; RegStats)
-&gt; [Matrix Double]
-&gt; [Vector]
-&gt; [Solution Double RegStats -&gt; RegStats]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679112852"><span class="annot"><span class="annottext">x :: Matrix Double
</span><a href="#local-6989586621679112852"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679112851"><span class="annot"><span class="annottext">y :: Vector
</span><a href="#local-6989586621679112851"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Vector Vector -&gt; Vector -&gt; Solution Double RegStats -&gt; RegStats
</span><a href="IT.Regression.html#fitnessTest"><span class="hs-identifier hs-var">fitnessTest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Matrix Double -&gt; Vector Vector
</span><a href="#local-6989586621679112861"><span class="hs-identifier hs-var">toRegMtx</span></a></span><span> </span><span class="annot"><span class="annottext">Matrix Double
</span><a href="#local-6989586621679112852"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector
</span><a href="#local-6989586621679112851"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Matrix Double]
</span><a href="#local-6989586621679112862"><span class="hs-identifier hs-var">tvXs</span></a></span><span> </span><span class="annot"><span class="annottext">[Vector]
</span><a href="#local-6989586621679112864"><span class="hs-identifier hs-var">tvYs</span></a></span><span>
</span><span id="line-99"></span><span>      </span><span>
</span><span id="line-100"></span><span>      </span><span id="local-6989586621679112849"><span class="annot"><span class="annottext">run :: Fitness Double RegStats
-&gt; (Solution Double RegStats -&gt; RegStats) -&gt; IO Double
</span><a href="#local-6989586621679112849"><span class="hs-identifier hs-var hs-var">run</span></a></span></span><span> </span><span id="local-6989586621679112848"><span class="annot"><span class="annottext">fitTr :: Fitness Double RegStats
</span><a href="#local-6989586621679112848"><span class="hs-identifier hs-var">fitTr</span></a></span></span><span> </span><span id="local-6989586621679112847"><span class="annot"><span class="annottext">fitTe :: Solution Double RegStats -&gt; RegStats
</span><a href="#local-6989586621679112847"><span class="hs-identifier hs-var">fitTe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fitness Double RegStats
-&gt; (Solution Double RegStats -&gt; RegStats)
-&gt; Int
-&gt; MutationCfg
-&gt; Int
-&gt; Int
-&gt; IO Double
</span><a href="RunCrossVal.html#runITEARegCV"><span class="hs-identifier hs-var">runITEARegCV</span></a></span><span> </span><span class="annot"><span class="annottext">Fitness Double RegStats
</span><a href="#local-6989586621679112848"><span class="hs-identifier hs-var">fitTr</span></a></span><span> </span><span class="annot"><span class="annottext">Solution Double RegStats -&gt; RegStats
</span><a href="#local-6989586621679112847"><span class="hs-identifier hs-var">fitTe</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112890"><span class="hs-identifier hs-var">dim</span></a></span><span> </span><span class="annot"><span class="annottext">MutationCfg
</span><a href="#local-6989586621679112903"><span class="hs-identifier hs-var">mutCfg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112902"><span class="hs-identifier hs-var">pop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112901"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-101"></span><span>      </span><span>
</span><span id="line-102"></span><span>  </span><span id="local-6989586621679112846"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679112846"><span class="hs-identifier hs-var">rmses</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[IO Double] -&gt; IO [Double]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">([IO Double] -&gt; IO [Double]) -&gt; [IO Double] -&gt; IO [Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Fitness Double RegStats
 -&gt; (Solution Double RegStats -&gt; RegStats) -&gt; IO Double)
-&gt; [Fitness Double RegStats]
-&gt; [Solution Double RegStats -&gt; RegStats]
-&gt; [IO Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Fitness Double RegStats
-&gt; (Solution Double RegStats -&gt; RegStats) -&gt; IO Double
</span><a href="#local-6989586621679112849"><span class="hs-identifier hs-var">run</span></a></span><span> </span><span class="annot"><span class="annottext">[Fitness Double RegStats]
</span><a href="#local-6989586621679112858"><span class="hs-identifier hs-var">fitTrains</span></a></span><span> </span><span class="annot"><span class="annottext">[Solution Double RegStats -&gt; RegStats]
</span><a href="#local-6989586621679112853"><span class="hs-identifier hs-var">fitTests</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; IO Double
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; IO Double) -&gt; Double -&gt; IO Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a (t :: * -&gt; *). (Fractional a, Foldable t) =&gt; t a -&gt; a
</span><a href="RunCrossVal.html#average"><span class="hs-identifier hs-var">average</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679112846"><span class="hs-identifier hs-var">rmses</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span>
</span><span id="line-106"></span><span class="hs-comment">-- | Main function</span><span>
</span><span id="line-107"></span><span class="annot"><a href="RunCrossVal.html#runCrossVal"><span class="hs-identifier hs-type">runCrossVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span id="runCrossVal"><span class="annot"><span class="annottext">runCrossVal :: [String] -&gt; IO ()
</span><a href="RunCrossVal.html#runCrossVal"><span class="hs-identifier hs-var hs-var">runCrossVal</span></a></span></span><span> </span><span id="local-6989586621679112843"><span class="annot"><span class="annottext">args :: [String]
</span><a href="#local-6989586621679112843"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-comment">-- generate all combination of configurations</span><span>
</span><span id="line-111"></span><span>    </span><span id="local-6989586621679112842"><span class="annot"><span class="annottext">allCfgs :: [(MutationCfg, Int, Int)]
</span><a href="#local-6989586621679112842"><span class="hs-identifier hs-var hs-var">allCfgs</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int -&gt; Int -&gt; (MutationCfg, Int, Int)
forall c.
Integral c =&gt;
(Int, Int) -&gt; Int -&gt; c -&gt; (MutationCfg, c, c)
</span><a href="RunCrossVal.html#createMutCfg"><span class="hs-identifier hs-var">createMutCfg</span></a></span><span class="hs-special">]</span><span> </span><span>
</span><span id="line-112"></span><span>                  </span><span class="annot"><span class="annottext">[(Int, Int) -&gt; Int -&gt; Int -&gt; (MutationCfg, Int, Int)]
-&gt; [(Int, Int)] -&gt; [Int -&gt; Int -&gt; (MutationCfg, Int, Int)]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>                  </span><span class="annot"><span class="annottext">[Int -&gt; Int -&gt; (MutationCfg, Int, Int)]
-&gt; [Int] -&gt; [Int -&gt; (MutationCfg, Int, Int)]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">10</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-number">15</span></span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span>                  </span><span class="annot"><span class="annottext">[Int -&gt; (MutationCfg, Int, Int)]
-&gt; [Int] -&gt; [(MutationCfg, Int, Int)]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">100</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">250</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">500</span></span><span class="hs-special">]</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679112841"><span class="annot"><span class="annottext">dname :: String
</span><a href="#local-6989586621679112841"><span class="hs-identifier hs-var">dname</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112840"><span class="annot"><span class="annottext">nfold :: Int
</span><a href="#local-6989586621679112840"><span class="hs-identifier hs-var">nfold</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; (String, Int)
</span><a href="RunCrossVal.html#validateArgs"><span class="hs-identifier hs-var">validateArgs</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679112843"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679112839"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679112839"><span class="hs-identifier hs-var">tests</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((MutationCfg, Int, Int) -&gt; IO Double)
-&gt; [(MutationCfg, Int, Int)] -&gt; IO [Double]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int -&gt; (MutationCfg, Int, Int) -&gt; IO Double
</span><a href="RunCrossVal.html#runCfg"><span class="hs-identifier hs-var">runCfg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679112841"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112840"><span class="hs-identifier hs-var">nfold</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(MutationCfg, Int, Int)]
</span><a href="#local-6989586621679112842"><span class="hs-identifier hs-var">allCfgs</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679112837"><span class="annot"><span class="annottext">bestCfg :: (MutationCfg, Int, Int)
</span><a href="#local-6989586621679112837"><span class="hs-identifier hs-var">bestCfg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679112836"><span class="annot"><span class="annottext">bestRMSE :: Double
</span><a href="#local-6989586621679112836"><span class="hs-identifier hs-var">bestRMSE</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((MutationCfg, Int, Int), Double)
 -&gt; ((MutationCfg, Int, Int), Double) -&gt; Ordering)
-&gt; [((MutationCfg, Int, Int), Double)]
-&gt; ((MutationCfg, Int, Int), Double)
forall (t :: * -&gt; *) a.
Foldable t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">minimumBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(((MutationCfg, Int, Int), Double) -&gt; Double)
-&gt; ((MutationCfg, Int, Int), Double)
-&gt; ((MutationCfg, Int, Int), Double)
-&gt; Ordering
forall a b. Ord a =&gt; (b -&gt; a) -&gt; b -&gt; b -&gt; Ordering
</span><span class="hs-identifier hs-var">comparing</span></span><span> </span><span class="annot"><span class="annottext">((MutationCfg, Int, Int), Double) -&gt; Double
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(MutationCfg, Int, Int)]
-&gt; [Double] -&gt; [((MutationCfg, Int, Int), Double)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[(MutationCfg, Int, Int)]
</span><a href="#local-6989586621679112842"><span class="hs-identifier hs-var">allCfgs</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679112839"><span class="hs-identifier hs-var">tests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO ()
forall a. Show a =&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">print</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679112841"><span class="hs-identifier hs-var">dname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679112840"><span class="hs-identifier hs-var">nfold</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(MutationCfg, Int, Int) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(MutationCfg, Int, Int)
</span><a href="#local-6989586621679112837"><span class="hs-identifier hs-var">bestCfg</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679112836"><span class="hs-identifier hs-var">bestRMSE</span></a></span><span>
</span><span id="line-122"></span></pre></body></html>
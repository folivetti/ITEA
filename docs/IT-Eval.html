<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>IT.Eval</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="src/IT.Eval.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>(c) Fabricio Olivetti de Franca 2020</td></tr><tr><th>License</th><td>GPL-3</td></tr><tr><th>Maintainer</th><td>fabricio.olivetti@gmail.com</td></tr><tr><th>Stability</th><td>experimental</td></tr><tr><th>Portability</th><td>POSIX</td></tr><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">IT.Eval</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Evaluation of the Transformation functions </a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Definition of functions pertaining to the conversion
and evaluation of an IT-expression. </p><p>TODO: move interval evaluation to IT.Eval.Interval </p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:log1p">log1p</a> :: Floating a =&gt; a -&gt; a</li><li class="src short"><a href="#v:transform">transform</a> :: Floating a =&gt; <a href="IT.html#t:Transformation" title="IT">Transformation</a> -&gt; a -&gt; a</li><li class="src short"><a href="#v:derivative">derivative</a> :: Floating a =&gt; <a href="IT.html#t:Transformation" title="IT">Transformation</a> -&gt; a -&gt; a</li><li class="src short"><a href="#v:sndDerivative">sndDerivative</a> :: Floating a =&gt; <a href="IT.html#t:Transformation" title="IT">Transformation</a> -&gt; a -&gt; a</li><li class="src short"><a href="#v:polynomial">polynomial</a> :: <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Interaction" title="IT">Interaction</a> -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double</li><li class="src short"><a href="#v:polynomialInterval">polynomialInterval</a> :: [Interval Double] -&gt; <a href="IT.html#t:Interaction" title="IT">Interaction</a> -&gt; Interval Double</li><li class="src short"><a href="#v:evalTerm">evalTerm</a> :: <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double</li><li class="src short"><a href="#v:evalTermInterval">evalTermInterval</a> :: [Interval Double] -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; Interval Double</li><li class="src short"><a href="#v:evalTermDiff">evalTermDiff</a> :: Int -&gt; <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double</li><li class="src short"><a href="#v:evalTermSndDiff">evalTermSndDiff</a> :: Int -&gt; Int -&gt; <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double</li><li class="src short"><a href="#v:evalTermDiffInterval">evalTermDiffInterval</a> :: Int -&gt; [Interval Double] -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; Interval Double</li><li class="src short"><a href="#v:evalTermSndDiffInterval">evalTermSndDiffInterval</a> :: Int -&gt; Int -&gt; [Interval Double] -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; Interval Double</li><li class="src short"><a href="#v:evalGeneric">evalGeneric</a> :: (<a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double) -&gt; <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double</li><li class="src short"><a href="#v:evalExpr">evalExpr</a> :: <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double</li><li class="src short"><a href="#v:evalDiff">evalDiff</a> :: Int -&gt; <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double</li><li class="src short"><a href="#v:evalSndDiff">evalSndDiff</a> :: Int -&gt; Int -&gt; <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double</li><li class="src short"><a href="#v:evalImageGeneric">evalImageGeneric</a> :: ([Interval Double] -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; Interval Double) -&gt; [Interval Double] -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; Interval Double</li><li class="src short"><a href="#v:evalImage">evalImage</a> :: [Interval Double] -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; Interval Double</li><li class="src short"><a href="#v:evalDiffImage">evalDiffImage</a> :: Int -&gt; [Interval Double] -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; Interval Double</li><li class="src short"><a href="#v:evalSndDiffImage">evalSndDiffImage</a> :: Int -&gt; Int -&gt; [Interval Double] -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; Interval Double</li><li class="src short"><a href="#v:isInvalid">isInvalid</a> :: Double -&gt; Bool</li><li class="src short"><a href="#v:isValid">isValid</a> :: [Double] -&gt; Bool</li><li class="src short"><a href="#v:exprToMatrix">exprToMatrix</a> :: <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; Matrix Double</li><li class="src short"><a href="#v:cleanExpr">cleanExpr</a> :: <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; (<a href="IT.html#t:Expr" title="IT">Expr</a>, Matrix Double)</li><li class="src short"><a href="#v:notInfNan">notInfNan</a> :: <a href="IT-Algorithms.html#t:Solution" title="IT.Algorithms">Solution</a> -&gt; Bool</li><li class="src short"><a href="#v:nanInterval">nanInterval</a> :: RealFloat a =&gt; Interval a</li><li class="src short"><a href="#v:hasInf">hasInf</a> :: RealFloat a =&gt; Interval a -&gt; Bool</li><li class="src short"><a href="#v:protected">protected</a> :: RealFloat a =&gt; (Interval a -&gt; Interval a) -&gt; Interval a -&gt; Interval a</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:log1p" class="def">log1p</a> :: Floating a =&gt; a -&gt; a <a href="src/IT.Eval.html#log1p" class="link">Source</a> <a href="#v:log1p" class="selflink">#</a></p><div class="doc"><p>log(x+1)</p></div></div><a href="#g:1" id="g:1"><h1>Evaluation of the Transformation functions </h1></a><div class="top"><p class="src"><a id="v:transform" class="def">transform</a> :: Floating a =&gt; <a href="IT.html#t:Transformation" title="IT">Transformation</a> -&gt; a -&gt; a <a href="src/IT.Eval.html#transform" class="link">Source</a> <a href="#v:transform" class="selflink">#</a></p><div class="doc"><p>Evaluate the transformation function <code>f</code> in a data point <code>x</code>.</p></div></div><div class="top"><p class="src"><a id="v:derivative" class="def">derivative</a> :: Floating a =&gt; <a href="IT.html#t:Transformation" title="IT">Transformation</a> -&gt; a -&gt; a <a href="src/IT.Eval.html#derivative" class="link">Source</a> <a href="#v:derivative" class="selflink">#</a></p><div class="doc"><p>Evaluate the derivative of a transformation function. </p></div></div><div class="top"><p class="src"><a id="v:sndDerivative" class="def">sndDerivative</a> :: Floating a =&gt; <a href="IT.html#t:Transformation" title="IT">Transformation</a> -&gt; a -&gt; a <a href="src/IT.Eval.html#sndDerivative" class="link">Source</a> <a href="#v:sndDerivative" class="selflink">#</a></p><div class="doc"><p>Evaluate the second derivative of the transformation function. </p></div></div><div class="top"><p class="src"><a id="v:polynomial" class="def">polynomial</a> :: <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Interaction" title="IT">Interaction</a> -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double <a href="src/IT.Eval.html#polynomial" class="link">Source</a> <a href="#v:polynomial" class="selflink">#</a></p><div class="doc"><p>Evaluates the interaction <code>ks</code> in the dataset <code>xss</code></p><p>It folds the map of exponents with the key, retrieve the corresponding column,
 calculates x_i^k_i and multiplies to the accumulator.
 It return a column vector. </p></div></div><div class="top"><p class="src"><a id="v:polynomialInterval" class="def">polynomialInterval</a> :: [Interval Double] -&gt; <a href="IT.html#t:Interaction" title="IT">Interaction</a> -&gt; Interval Double <a href="src/IT.Eval.html#polynomialInterval" class="link">Source</a> <a href="#v:polynomialInterval" class="selflink">#</a></p><div class="doc"><p>Evaluates the interval of the interaction w.r.t. the domains of the variables.</p><p>In this case it is faster to fold through the list of domains and checking whether we 
 have a nonzero strength.</p></div></div><div class="top"><p class="src"><a id="v:evalTerm" class="def">evalTerm</a> :: <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double <a href="src/IT.Eval.html#evalTerm" class="link">Source</a> <a href="#v:evalTerm" class="selflink">#</a></p><div class="doc"><p>Evaluates a term by applying the transformation function to
 the result of the interaction.</p></div></div><div class="top"><p class="src"><a id="v:evalTermInterval" class="def">evalTermInterval</a> :: [Interval Double] -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; Interval Double <a href="src/IT.Eval.html#evalTermInterval" class="link">Source</a> <a href="#v:evalTermInterval" class="selflink">#</a></p><div class="doc"><p>Evaluates the term on the interval domains. </p></div></div><div class="top"><p class="src"><a id="v:evalTermDiff" class="def">evalTermDiff</a> :: Int -&gt; <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double <a href="src/IT.Eval.html#evalTermDiff" class="link">Source</a> <a href="#v:evalTermDiff" class="selflink">#</a></p><div class="doc"><p>The partial derivative of a term w.r.t. the variable ix is:</p><p>If ix exists in the interaction, the derivative is:
      derivative t (polynomial xss ks) * (polynomial xss ks') 
      ks' is the same as ks but with the strength of ix decremented by one
 Otherwise it is equal to 0</p><p>Given the expression: w1 t1(p1(x)) + w2 t2(p2(x))
 The derivative is: w1 t1'(p1(x))p1'(x) + w2 t2'(p2(x))p2'(x)</p></div></div><div class="top"><p class="src"><a id="v:evalTermSndDiff" class="def">evalTermSndDiff</a> :: Int -&gt; Int -&gt; <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double <a href="src/IT.Eval.html#evalTermSndDiff" class="link">Source</a> <a href="#v:evalTermSndDiff" class="selflink">#</a></p><div class="doc"><p>The second partial derivative of a term w.r.t. the variables ix and iy is:</p><p>given p(x) as the interaction function, t(x) the transformation function,
 f'(x)|i the first derivative of a function given i and f''(x) the second derivative. </p><p>If iy exists in p(x) and ix exists in p'(x)|iy, the derivative is:</p><p>kx*ky*t''(x)*p'(x)|ix * p'(x)|iy + kxy*t'(x)p''(x)</p><p>where kx, ky are the original exponents of variables ix and iy,
     and kxy is ky * kx', with kx' the exponent of ix on p'(x)|iy</p></div></div><div class="top"><p class="src"><a id="v:evalTermDiffInterval" class="def">evalTermDiffInterval</a> :: Int -&gt; [Interval Double] -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; Interval Double <a href="src/IT.Eval.html#evalTermDiffInterval" class="link">Source</a> <a href="#v:evalTermDiffInterval" class="selflink">#</a></p><div class="doc"><p>Same as <code><a href="IT-Eval.html#v:evalTermDiff" title="IT.Eval">evalTermDiff</a></code> but optimized for intervals. </p></div></div><div class="top"><p class="src"><a id="v:evalTermSndDiffInterval" class="def">evalTermSndDiffInterval</a> :: Int -&gt; Int -&gt; [Interval Double] -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; Interval Double <a href="src/IT.Eval.html#evalTermSndDiffInterval" class="link">Source</a> <a href="#v:evalTermSndDiffInterval" class="selflink">#</a></p><div class="doc"><p>Same as <code><a href="IT-Eval.html#v:evalTermSndDiff" title="IT.Eval">evalTermSndDiff</a></code> but optimized for intervals </p></div></div><div class="top"><p class="src"><a id="v:evalGeneric" class="def">evalGeneric</a> :: (<a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double) -&gt; <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double <a href="src/IT.Eval.html#evalGeneric" class="link">Source</a> <a href="#v:evalGeneric" class="selflink">#</a></p><div class="doc"><p>evaluates an expression by evaluating the terms into a list
 applying the weight and summing the results.</p></div></div><div class="top"><p class="src"><a id="v:evalExpr" class="def">evalExpr</a> :: <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double <a href="src/IT.Eval.html#evalExpr" class="link">Source</a> <a href="#v:evalExpr" class="selflink">#</a></p><div class="doc"><p>Evaluating an expression is simply applying <code><a href="IT-Eval.html#v:evalTerm" title="IT.Eval">evalTerm</a></code> </p></div></div><div class="top"><p class="src"><a id="v:evalDiff" class="def">evalDiff</a> :: Int -&gt; <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double <a href="src/IT.Eval.html#evalDiff" class="link">Source</a> <a href="#v:evalDiff" class="selflink">#</a></p><div class="doc"><p>Evaluating the derivative is applying <code><a href="IT-Eval.html#v:evalTermDiff" title="IT.Eval">evalTermDiff</a></code> in the expression </p></div></div><div class="top"><p class="src"><a id="v:evalSndDiff" class="def">evalSndDiff</a> :: Int -&gt; Int -&gt; <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; <a href="IT.html#t:Column" title="IT">Column</a> Double <a href="src/IT.Eval.html#evalSndDiff" class="link">Source</a> <a href="#v:evalSndDiff" class="selflink">#</a></p><div class="doc"><p>Evaluating the second derivative is applying <code><a href="IT-Eval.html#v:evalTermSndDiff" title="IT.Eval">evalTermSndDiff</a></code> in the expression</p></div></div><div class="top"><p class="src"><a id="v:evalImageGeneric" class="def">evalImageGeneric</a> :: ([Interval Double] -&gt; <a href="IT.html#t:Term" title="IT">Term</a> -&gt; Interval Double) -&gt; [Interval Double] -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; Interval Double <a href="src/IT.Eval.html#evalImageGeneric" class="link">Source</a> <a href="#v:evalImageGeneric" class="selflink">#</a></p><div class="doc"><p>Returns the estimate of the image of the funcion with Interval Arithmetic</p><p>this requires a different implementation from <code><a href="IT-Eval.html#v:evalGeneric" title="IT.Eval">evalGeneric</a></code></p></div></div><div class="top"><p class="src"><a id="v:evalImage" class="def">evalImage</a> :: [Interval Double] -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; Interval Double <a href="src/IT.Eval.html#evalImage" class="link">Source</a> <a href="#v:evalImage" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:evalDiffImage" class="def">evalDiffImage</a> :: Int -&gt; [Interval Double] -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; Interval Double <a href="src/IT.Eval.html#evalDiffImage" class="link">Source</a> <a href="#v:evalDiffImage" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:evalSndDiffImage" class="def">evalSndDiffImage</a> :: Int -&gt; Int -&gt; [Interval Double] -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; [Double] -&gt; Interval Double <a href="src/IT.Eval.html#evalSndDiffImage" class="link">Source</a> <a href="#v:evalSndDiffImage" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:isInvalid" class="def">isInvalid</a> :: Double -&gt; Bool <a href="src/IT.Eval.html#isInvalid" class="link">Source</a> <a href="#v:isInvalid" class="selflink">#</a></p><div class="doc"><p>A value is invalid if it's wether NaN or Infinite</p></div></div><div class="top"><p class="src"><a id="v:isValid" class="def">isValid</a> :: [Double] -&gt; Bool <a href="src/IT.Eval.html#isValid" class="link">Source</a> <a href="#v:isValid" class="selflink">#</a></p><div class="doc"><p>a set of points is valid if none of its values are invalid and
 the maximum abosolute value is below 1e150 (to avoid overflow)</p></div></div><div class="top"><p class="src"><a id="v:exprToMatrix" class="def">exprToMatrix</a> :: <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; Matrix Double <a href="src/IT.Eval.html#exprToMatrix" class="link">Source</a> <a href="#v:exprToMatrix" class="selflink">#</a></p><div class="doc"><p>evaluate an expression to a set of samples </p><p>(1 LA.|||) adds a bias dimension</p></div></div><div class="top"><p class="src"><a id="v:cleanExpr" class="def">cleanExpr</a> :: <a href="IT.html#t:Dataset" title="IT">Dataset</a> Double -&gt; <a href="IT.html#t:Expr" title="IT">Expr</a> -&gt; (<a href="IT.html#t:Expr" title="IT">Expr</a>, Matrix Double) <a href="src/IT.Eval.html#cleanExpr" class="link">Source</a> <a href="#v:cleanExpr" class="selflink">#</a></p><div class="doc"><p>Clean the expression by removing the invalid terms
 TODO: move to IT.Regression </p></div></div><div class="top"><p class="src"><a id="v:notInfNan" class="def">notInfNan</a> :: <a href="IT-Algorithms.html#t:Solution" title="IT.Algorithms">Solution</a> -&gt; Bool <a href="src/IT.Eval.html#notInfNan" class="link">Source</a> <a href="#v:notInfNan" class="selflink">#</a></p><div class="doc"><p>Checks if the fitness of a solution is not Inf nor NaN.</p></div></div><div class="top"><p class="src"><a id="v:nanInterval" class="def">nanInterval</a> :: RealFloat a =&gt; Interval a <a href="src/IT.Eval.html#nanInterval" class="link">Source</a> <a href="#v:nanInterval" class="selflink">#</a></p><div class="doc"><p>definition of an interval evaluated to NaN</p></div></div><div class="top"><p class="src"><a id="v:hasInf" class="def">hasInf</a> :: RealFloat a =&gt; Interval a -&gt; Bool <a href="src/IT.Eval.html#hasInf" class="link">Source</a> <a href="#v:hasInf" class="selflink">#</a></p><div class="doc"><p>Check if any bound of the interval is infinity</p></div></div><div class="top"><p class="src"><a id="v:protected" class="def">protected</a> :: RealFloat a =&gt; (Interval a -&gt; Interval a) -&gt; Interval a -&gt; Interval a <a href="src/IT.Eval.html#protected" class="link">Source</a> <a href="#v:protected" class="selflink">#</a></p><div class="doc"><p>Creates a protected function to avoid throwing exceptions</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.0</p></div></body></html>